<!DOCTYPE html>
<html layout:decorate="~{layout}" lang="ko" xmlns:th="http://www.thymeleaf.org">
<div layout:fragment="content" class="container my-3">
<head>
    <meta charset="UTF-8">
    <title>비밀번호 재설정</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #f4f4f4; }
        .reset-form { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); width: 300px; }
        .reset-form h2 { text-align: center; }
        .reset-form label, .reset-form input { display: block; width: 100%; margin-bottom: 10px; }
        .reset-form input[type="password"] { padding: 8px; box-sizing: border-box; }
        .reset-form button { width: 100%; padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="reset-form">
        <h2>비밀번호 재설정</h2>
<!--         <form action="/user/reset-password/setting" method="post"> -->

<!-- 밑에 자바스크립트에서 id불러서 강제로 경로지정 -->
			 <form id="reset-form" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

            <input type="hidden" id="uuid" name="uuid" value="">
            
            <label for="new-password">새 비밀번호</label>
            <input type="password" id="new-password" name="newPassword" required>

            <label for="confirm-password">새 비밀번호 확인</label>
            <input type="password" id="confirm-password" name="newPasswordConfirm" required>
            
            <button type="submit">비밀번호 변경</button>
        </form>
    </div>
<!--  이전 코드인데 url uuid 문제있어서 일단 닫아둠 -->
<!--     <script>
        // URL에서 UUID를 추출하는 로직
        const urlPath = window.location.pathname;
        const uuid = urlPath.substring(urlPath.lastIndexOf('/') + 1);
        document.getElementById('uuid').value = uuid;

        // 비밀번호 일치 여부 확인 (클라이언트 측 유효성 검사)
        document.querySelector('form').addEventListener('submit', function(event) {
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            if (newPassword !== confirmPassword) {
                alert('비밀번호가 일치하지 않습니다.');
                event.preventDefault();
            }
        });
    </script> -->
 
 
<!--  최신버전 -->
    <script>
        // URL에서 UUID를 추출하는 로직
        const urlPath = window.location.pathname;
        const uuid = urlPath.substring(urlPath.lastIndexOf('/') + 1);
        
        // 폼의 action URL을 동적으로 설정
        const form = document.getElementById('reset-form');
        form.action = '/user/reset-password/setting/' + uuid;

        // 비밀번호 일치 여부 확인 (클라이언트 측 유효성 검사)
        document.querySelector('form').addEventListener('submit', function(event) {
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            if (newPassword !== confirmPassword) {
                alert('비밀번호가 일치하지 않습니다.');
                event.preventDefault();
            }
        });
    </script>
</body>
</div>
</html>