<html layout:decorate="~{layout}" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>

<title>비밀번호 재설정</title>
<style>
/*         body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #f4f4f4; } */
/*         .reset-form { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); width: 300px; } */
/*         .reset-form h2 { text-align: center; } */
/*         .reset-form label, .reset-form input { display: block; width: 100%; margin-bottom: 10px; } */
/*         .reset-form input[type="password"] { padding: 8px; box-sizing: border-box; } */
/*         .reset-form button { width: 100%; padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; } */
</style>
</head>
<div layout:fragment="content" class="container my-3">

	<div class="reset-form">
		<h2>비밀번호 재설정</h2>

		<div th:if="${errorMessage}" class="alert alert-danger">
			<ul>
				<li th:each="error : ${errorMessage}"
					th:text="${error.defaultMessage}"></li>
			</ul>
		</div>

		<!--         <form action="/user/reset-password/setting" method="post"> -->

		<!-- 밑에 자바스크립트에서 id불러서 강제로 경로지정 -->
		<form id="reset-form" method="post">
			<input type="hidden" th:name="${_csrf.parameterName}"
				th:value="${_csrf.token}" /> <input type="hidden" id="uuid"
				name="uuid" value="{uuid}">

			<p>특수문자, 대문자를 1개이상 포함해야합니다.</p>
			<p>4글자 이상, 25글자 이하만 가능합니다.</p>
			<br> <label for="new-password" class="form-label">새 비밀번호</label>
			<input type="password" id="new-password" class="form-control"
				name="newPassword" required> <br> <label
				for="confirm-password" class="form-label">새 비밀번호 확인</label> <input
				type="password" id="confirm-password" class="form-control"
				name="newPasswordConfirm" required> <br>
			<button type="submit" class ="btn btn-info">비밀번호 변경</button>
		</form>
	</div>

</div>



<!--  최신버전 -->
<script layout:fragment="script" type="text/javascript"
	th:inline="javascript">
	// URL에서 UUID를 추출하는 로직
	const urlPath = window.location.pathname;
	const uuid = urlPath.substring(urlPath.lastIndexOf('/') + 1);

	// 폼의 action URL을 동적으로 설정
	const form = document.getElementById('reset-form');
	form.action = '/user/reset-password/setting/' + uuid;

	var serverErrorMessage = /*[[${errorMessage}]]*/null;

	// 메시지가 존재하면 alert 창 띄우기
	if (serverError) {
		serverError.forEach(function(error) {
			alert(error.defaultMessage);
		});
	}

	// =======================================================================        


	document
			.querySelector('form')
			.addEventListener(
					'submit',
					function(event) {
						const passwordPattern = /^(?=.*[A-Z])(?=.*[^A-Za-z0-9]).{4,}$/;
						const newPassword = document
								.getElementById('new-password').value;
						const confirmPassword = document
								.getElementById('confirm-password').value;
					});

</script>
</html>